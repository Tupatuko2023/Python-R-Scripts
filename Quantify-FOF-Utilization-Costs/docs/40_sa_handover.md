# Solution Architecture Handover: Aim 2 Analysis (FOF Utilization & Costs)

## Project Summary
**Goal:** Quantify Fear of Falling (FOF) related health-service utilization and costs (Aim 2).
This project implements a secure, hybrid pipeline to analyze register data while adhering to **Option B** security protocols (raw data remains external to the repository).

## Methodology

### 1. Hybrid Analysis Pipeline
The solution utilizes a multi-language approach to leverage the strengths of different ecosystems:
*   **Python (Data Engineering):** Used for initial data discovery, inventory management (`00_inventory_manifest.py`), and complex data assembly/QC (`20_assemble_paper02.py`, `30_qc_summary.py`).
*   **R (Statistics & Visualization):** Employed for heavy statistical modeling (`30_models_panel_nb_gamma.R`) and high-quality visualization using `ggplot2` and `ragg`.

### 2. Termux-Native Protocol
Executed in an Android Termux environment, necessitating specific operational guards:
*   **Wake Locks:** All long-running R modeling and visualization scripts are wrapped in `termux-wake-lock` to prevent the Android system from killing background processes during high CPU/Memory load.
*   **Graphics Backend:** Utilized `ragg` (AGP-based) for high-performance, system-independent PNG rendering, bypassing traditional X11/Cairo dependencies.
*   **Resource Management:** Explicit memory limits were enforced for Node/Gemini processes to ensure stability on mobile hardware.

### 3. Option B Security
*   **DATA_ROOT:** Raw inputs and participant-level derived sets (e.g., `aim2_panel.csv`) are stored in a repo-external directory.
*   **Aggregate-Only Exports:** All scripts are designed to export only safe, non-identifiable aggregate data (counts, ratios, means) and plots to the `outputs/` directory.

## Results Overview
The Aim 2 pipeline has successfully modeled utilization counts and costs:

*   **Utilization (Visits):** Negative Binomial models show an Incident Rate Ratio (IRR) of **~1.18** for FOF-positive participants compared to FOF-negative.
*   **Costs (EUR):** Gamma models (on positive costs) show a Cost Ratio of **~1.18** for FOF-positive participants.
*   **Artifacts:** 
    *   Forest plots of ratios (`forest_plot_ratios.png`).
    *   Temporal trends for visits and costs per person-year (`trend_visits_py.png`, `trend_costs_py.png`).
    *   QC missingness profiles (`qc_missingness_top15.png`).

## Limitations
*   **No Row-Level Export:** In compliance with Option B, no person-level datasets are available within the repo.
*   **Frailty Interactions:** The current modeling focuses on primary FOF status effects; complex interaction analyses (e.g., FOF * Frailty) were not implemented in this session.

## Next Steps
1.  **Review Knowledge Package:** Examine the generated figures in `outputs/figures/`.
2.  **Verify Manifest:** Ensure all new artifacts are tracked in `manifest/dataset_manifest.csv` if they are to be moved to permanent storage.
3.  **Cross-Project Sync:** The Fear-of-Falling (FOF) R pipeline in the neighboring directory may benefit from the standardized `ragg` visualization patterns established here.

---
*Generated by Gemini Termux Orchestrator (S-QF) - 2026-01-31*
